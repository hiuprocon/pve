title: memo.mm

ETRobo
========================================

EV3の倒立振子のシミュレーション

2017,07/12: ロボットの寸法とか重さとかかなり
適当だけど，一応立ったので公開．

倒立振子APIは以下の物を使わせてもらってるけど，
ライセンス的に含めて良いかわからないので
入れてない．

* <https://github.com/ETrobocon/etroboEV3/blob/master/SampleCode/EV3way_leJOS_sample/ev3sample/src/jp/etrobo/ev3/balancer/Balancer.java>
    + Balancer.java(2017,07/12)
    + md5=eeeb4203e3fc95ae6b5403ec21933a7b

かなりグラグラしてそのうち倒れるけど，
あとは調整すれば使えるかもしれない．

2017,07/14追記: 物理エンジンの安定性の問題から
全ての物体の大きさを10倍にして，シミュレーションの
ステップ間隔を1/30秒としている．で，この
シミュレーションステップを4ミリ秒と見做し，
1/10の多きさの物理シミュレーションに見えるように
するために，重力加速度と，モーターの出力を
調整するという作戦を採用する．ということで，
現在重力加速度は
-1.176=-9.8*(3/25)=-9.8*((4/1000)/(1/30))
なんだけど，なんか計算合ってない気がする．

-----

2017,07/14: NXTwayの方の情報だけど，EV3wayも
だいたい同じだと思うので，ネットで見付けた
情報をメモ．

* 重力加速度：g = 9.81[m/sec^2]
* 車輪1本の重量：m = 0.03[kg]
* 車輪の半径：R = 0.04[m]
* 車輪の慣性モーメント：Jw = mR^2/2 [kgm^2]
* 車体重量：M = 0.635[kg]
* 車体幅：W = 0.14[m]
* 車体奥行：D = 0.04[m]
* 車体高さ：H = 0.144[m]
* 車輪中心から車体充員までの距離：L = H/2[m]
* 車体慣性モーメント(ピッチ)：Jψ = ML^2/3 [kgm^2]
* 車体慣性モーメント(ヨー)：Jφ = M(W^2+D^2)/12 [kgm^2]
* DCモータ完成モーメント：Jm = 0.00001[kgm^2]
* DCモータ抵抗：Rm = 6.69[オーム]
* DCモータ逆起電力定数：Kb = 0.468[V sec/rad]
* DCモータトルク定数：Kt = 0.317[N m/A]
* ギア比：n = 1
* 車体とDCモータの間の摩擦係数：fm = 0.0022
* 車輪と路面間の摩擦係数：fw = 0

車輪の軸は車体底面と同じ高さで，2つの車輪の
間隔が車体幅と同じというザックリとしたデータ
みたい．慣性モーメントはProconVEに設定できる
API無いけど，重要かもしれない．作った方いいかなぁ？

で，見ただけでわかんなかったのがDCモーターの
項目．モーターの回転速度に応じて逆起電力が
生じるってとこまでシミュレーション必要なん
だろうか？たぶん，バッテリー電圧から逆起電力を
引いた値を使ってオームの法則で電流出して，その
電流とトルク定数からトルクを出し，それに加えて
PWM(Pulse Width Modulation)ってことで強弱
つけてあげれば最終的なトクルが出るのだと思う．

データのでどこは別だけど，バッテリー電圧は
9000mVぐらいでコース走ってる間でもわりと
かわるのかもしれない．(プラマイ100mVぐらい？)
なるほど0.468[V sec/rad]ってことは，全速力で
走ってる時なんかは特に，ちゃんと逆起電力考慮
しないと正確にシミュレーションできなさそう．

あと，カラーセンサの位置と，超音波センサの
位置も調べといた方が良いかも．

プログラムに反映させるのは，またそのうち．
